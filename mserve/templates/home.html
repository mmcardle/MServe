{% extends "base.html" %}

{% block title %}MServe Home{% endblock %}

{% block usages %}
    {% if user.is_staff %}
                    {% if usagesummary %}
                    {% for usagesummary in usagesummary %}
                        {% if usagesummary.metric == "http://mserve/disc_space" %}
                            <span>Largest File:&nbsp;&nbsp;<em>{{usagesummary.max|filesizeformat}}</em>&nbsp;&nbsp;&nbsp;</span>
                            <span>Average File Size:&nbsp;&nbsp;<em>{{usagesummary.avg|filesizeformat}}</em>&nbsp;&nbsp;&nbsp;</span>
                            <span>Disc Space Used:&nbsp;&nbsp;<em>{{usagesummary.sum|filesizeformat}}</em>&nbsp;&nbsp;&nbsp;</span>
                        {% endif %}
                        {% if usagesummary.metric == "http://prestoprime/responsetime" %}
                            <span>Average Response Time&nbsp;&nbsp;<em>{{usagesummary.avg}}s</em>&nbsp;&nbsp;&nbsp;</span>
                        {% endif %}
                        {% if usagesummary.metric == "http://mserve/container" %}
                            <span>Containers&nbsp;&nbsp;<em>{{usagesummary.n}}</em>&nbsp;&nbsp;&nbsp;</span>
                        {% endif %}
                        {% if usagesummary.metric == "http://mserve/service" %}
                            <span>Services&nbsp;&nbsp;<em>{{usagesummary.n}}</em>&nbsp;&nbsp;&nbsp;</span>
                        {% endif %}
                        {% if usagesummary.metric == "http://mserve/file" %}
                            <span>Files&nbsp;&nbsp;<em>{{usagesummary.n}}</em>&nbsp;&nbsp;&nbsp;</span>
                        {% endif %}
                    {% endfor %}
            {% endif %}
    {% endif %}
{% endblock %}

{% block content %}

{% endblock %}

{% block auths %}

{% endblock auths %}

{% block bottomscript %}
<script type="text/javascript">
$(document).ready(function() {
    $(function() {

            function loadURL(url) {
                console.log("loadURL: " + url);
                $("#mserve").mserve('loadpage',url)
	    }

            console.log("Loading URL from hash ... "+window.location.hash)

	    // Event handlers
	    $.address.init(function(event) {
	        console.log("init: " + $("[rel='address:" + event.value + "']").attr('href'));
	    }).change(function(event) {
                console.log("event.value :"+ event.value)
                r = $("[rel='address:" + event.value + "']").attr('href')
                console.log("r :"+ r)
                loadURL(event.value);
	    	console.log("change");
	    })

            $('a[rel]').address(function() {
                console.log("address this :"+this)
                //console.log("address this.href :"+this.attr('href'))
                console.log("address this.href.replace :"+$(this).attr('href').replace(/^#/, ''))
                r = $(this).attr('href').replace('/^#/', '');
                console.log(r)
                return  r
            });
    });
});
</script>
{% endblock %}
{% load mservetags %}
<h3>Usage Summary</h3>

{% if user.is_staff %}
<h4>Traffic</h4>
<div id="chart_div" style="width: 80%; height: 200px;margin-top: 16px;"></div>
<script>

$('#tabs').bind('tabsshow', function(event, ui) {
  if (ui.panel.id == "tabs-usage") {
    load_traffic_plot();
  }
});

</script>

{% endif %}

<h4>Statistics</h4>
<div id="usagecontent" >
{% if usagesummary %}
    <table class="table_usage" cellpadding="5" cellspacing="5">
        <tr><th align="left">Metric</th><th>Min</th><th>Max</th><th>Count</th><th>Average</th><th>Std. Dev</th><th>Variance</th></tr>
        {% for summary in usagesummary%}
            <tr>
                <td style="text-align: left;"><b>{{summary.metric}}</b></td>
                <td>{{summary.min}}</td>
                <td>{{summary.max}}</td>
                <td>{{summary.n}}</td>
                <td>{{summary.avg}}</td>
                <td>{{summary.stddev}}</td>
                <td>{{summary.var}}</td>
            </tr>
        {% endfor %}
    </table>
{% endif %}

<h3>Historical Usage</h3>
{% if usage %}
    <table class="table_usage" cellpadding="5" cellspacing="5">
        {% for u in usage %}
            {% if u.rate == 0.0 %}
            <tr>
                <td>Usage of <a href="/browse/{{u.base.id}}">{{u.base}}</a>&nbsp;</td><td><b>{{u.metric}}</b></td><td>at <b>{{u.fmt_rtime}}</b> was<td><b>{{u.total}}</b></td>
            </tr>
             {% else%}
            <tr>
                <td>Usage of <a href="/browse/{{u.base.id}}">{{u.base}}</a>&nbsp;</td><td><b>{{u.metric}}</b></td><td>at <b>{{u.fmt_rtime}}</b> was<td><b>{{u.rate}} per second</b></td>
            </tr>
            {% endif %}
        {% endfor %}
    </table>
{% endif %}
</div>

{%block usage %}

{%endblock usage %}
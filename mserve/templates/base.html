<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
    <script type="text/javascript" src="http://www.google.com/jsapi"></script>
    <script type="text/javascript">
      google.load('visualization', '1', {packages: ['orgchart']});
    </script>
    <style type="text/css" media="screen">
body {

    background: #e7e7e7;
    font-family: Tahoma, sans-serif;
    font-size: 10pt;

}

h1,h2,h3,h4,h5,h6 {
    color:#0000AA;
    margin:2px;
}

a, a:visited {
    text-decoration: none;
    border:none;
    color:#AA0000;
}
a img {
    border:none;
}

td {
        vertical-align: top;
}

#sidebar {
    vertical-align: top;
    margin-top: 20px;
    padding: 15px;

}

.auth {
    margin: 2px;
}

.authname {
    padding:2px;
    margin-top: 5px;
    font-weight: bold;
    font-size: 16px;
}
.method, .authid {
    padding:6px;
}
.table_usage th,.table_usage td {
    padding:1px;
    text-align: left;
}
.table_usage th {
    text-align: right;
    border:1px outset gray;
    background-color: #EEEEEE;
    padding-left: 3px;
    min-width: 50px;
}
.table_usage td {
    text-align: right;
}

</style>
    <!--<link rel="stylesheet" href="style.css" />-->
    <title>{% block title %}MServe{% endblock %}</title>
</head>

<body>
    <h3>{% block heading %}MServe{% endblock %}</h3>
    <table >
        <tr>
            <th id="sidebar" width="10%">
                {% block sidebar %}
                    <div><a href="/home/">Home</a></div>
                    <div><a href="/admin/">Admin</a></div>
                    <div><a href="/map/">Map</a></div>
                {% endblock %}
            </th>
            <td >
                {% block content %}{% endblock %}
            </td >
            <td>
                {% block rightcontent %}{% endblock %}
                {% block auths %}
                <h3>Auths</h3>

                {% if auths %}
                    
                    {% for auth in auths %}
                    <div class="auth">
                        <div class="authname">{{auth.authname}}</div>
                        {% for auth in auth.methods %}
                            <span class="method">{{auth}}</span>
                        {% endfor %}
                        <div class="authid"><a href="/auth/{{auth.id}}" >{{auth.id}}</a></div>
                    </div>
                    {% endfor %}
                    
                {% endif %}

                {% if not auths%}
                    <div>None</div>
                {% endif %}
                {% endblock auths %}
            </td>
        </tr>
        <tr>
            <td></td>
            <td colspan="2">

                <h3>Current Usage</h3>
                {% if usagerate %}
                    <table class="table_usage" cellpadding="5" cellspacing="5">
                        <tr><th align="left">Metric</th><th>Name</th><th>Last Report</th><th>Rate</th><th>Usage</th><th>Time</th></tr>
                        {% for usagerate in usagerate%}
                            <tr>
                                <td style="text-align: left;">{{usagerate.metric}}</td>
                                <td><a href="{{usagerate.path}}{{usagerate.base.id}}/">{{usagerate.base}}</a></td>
                                <td>{{usagerate.ctime}}</td>
                                <td>{{usagerate.calc_rate}}</td>
                                <td>{{usagerate.calc_so_far}}</td>
                                <td>{{usagerate.time_since_last_report}}</td>
                            </tr>
                        {% endfor %}
                    </table>
                {% endif %}

                {% if not usagerate %}
                    <div>None</div>
                {% endif %}

                <h3>Previous Usage</h3>
                {%block usage %}
                {% if usage %}
                    <table class="table_usage" cellpadding="5" cellspacing="5">
                        <tr><th align="left">Metric</th><th>Time</th><th>Value</th></tr>
                        {% for usage in usage%}
                            <tr>
                                <td style="text-align: left;">{{usage.metric}}</td>
                                <td>{{usage.fmt_ctime}}</td>
                                <td>{{usage.fmt_value}}</td>
                            </tr>
                        {% endfor %}
                    </table>
                {% endif %}

                {% if not usage %}
                    <div>None</div>
                {% endif %}

                <h3>UsageSummary</h3>
                {% if usagesummary %}
                    <table class="table_usage" cellpadding="5" cellspacing="5">
                        <tr><th align="left">Metric</th><th>Num</th><th>Sum</th><th>Min</th><th>Max</th><th>Sums</th></tr>
                        {% for usagesummary in usagesummary %}
                            <tr>
                                <td  style="text-align: left;">{{usagesummary.metric}}</td>
                                <td>{{usagesummary.fmt_n}}</td>
                                <td>{{usagesummary.fmt_sum}}</td>
                                <td>{{usagesummary.fmt_min}}</td>
                                <td>{{usagesummary.fmt_max}}</td>
                                <td>{{usagesummary.fmt_sums}}</td>
                            </tr>
                        {% endfor %}
                    </table>
                {% endif %}

                {% if not usagesummary %}
                    <div>None</div>
                {% endif %}

                {%endblock usage %}
            </td>
        </tr>

    </table>
</body>
</html>
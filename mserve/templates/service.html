{% extends "base.html" %}

{% block title %}MServe Service{% endblock %}

{% block usages %}
    <span>Number of Files:&nbsp;&nbsp;<em>{{service.mfile_set.all|length}}</em>&nbsp;&nbsp;&nbsp;</span>
    <span>Number of Jobs:&nbsp;&nbsp;<em>{{service.job_set.all|length}}</em>&nbsp;&nbsp;&nbsp;</span>
    {% if usagesummary %}
            {% for usagesummary in usagesummary %}
                {% if usagesummary.metric == "http://mserve/disc_space" %}
                            <span>Largest File:&nbsp;&nbsp;<em>{{usagesummary.max|filesizeformat}}</em>&nbsp;&nbsp;&nbsp;</span>
                            <span>Average File Size:&nbsp;&nbsp;<em>{{usagesummary.avg|filesizeformat}}</em>&nbsp;&nbsp;&nbsp;</span>
                            <span>Disc Space Used:&nbsp;&nbsp;<em>{{usagesummary.sum|filesizeformat}}</em>&nbsp;&nbsp;&nbsp;</span>
                {% endif %}
                {% if usagesummary.metric == "http://mserve/responsetime" %}
                    <span>Average Response Time&nbsp;&nbsp;<em>{{usagesummary.avg|floatformat}}s</em>&nbsp;&nbsp;&nbsp;</span>
                {% endif %}

            {% endfor %}
    {% endif %}
{% endblock %}

{% block main_img %}

<div id="dropbox" style="overflow:hidden;height: 164px;" >

    <div style="width: 266px; height:57px">
        <form id="file_upload" action="/services/{{service.id}}/mfiles/"
              method="POST" enctype="multipart/form-data"
              style="width: 100%;height: 100%;" >
            <input type="hidden" value="{{service.id}}" name="sid" />
                <input type="file" name="file" multiple>
                <button>Upload</button>
                <div class="file_upload_label"><h4>Drop Files Here</h4></div>
        </form>
    </div>

    <div id="files" style="width: 266px; height:97px; overflow: auto; margin-top: 4px;"  >
        <h4>In Progress</h4>
    </div>

</div>

{% endblock %}

{% block content %}

<div class="demo">

<div id="tabs">
	<ul>
		<li><a href="#tabs-1">Files</a></li>
		<li><a href="#jobs-tab">Jobs</a></li>
		<li><a href="#tabs-3">Actions</a></li>
		<li><a href="#tabs-4">Config</a></li>
		<li><a href="#tabs-usage">Usage</a></li>
		<li><a href="#tabs-6">Access Control</a></li>
	</ul>

	<div id="tabs-1">
            
        <div class="paginator" id="mfilepaginator"></div>

        <div id="mfilemessages"></div>

        <div id="managedresourcesmfilescontent">
        </div>

        <h3>Actions</h3>
        <button id="newjobbutton" >New Job</button>

        </div>
        <div id="jobs-tab">
             <h3>Jobs</h3>

            <div id="jobs">

            </div>

            <div id="set-management-property-button-dialog-form" title="Set Management Property">
                <p class="validateTips">Input management property and value.</p>

                <form >
                <fieldset>
                    <legend></legend>
                        <label for="property">Property</label>
                        <input type="text" name="prop" id="prop" class="text ui-widget-content ui-corner-all" />
                        <label for="value">Value</label>
                        <input type="text" name="val" id="val" value="" class="text ui-widget-content ui-corner-all" />
                </fieldset>
                </form>
            </div>

            <script type="text/javascript">
                $(document).ready(function() {
                    loadMFiles('{{service.id}}');
                    loadJobs('{{service.id}}');
                    $('#newjobbutton').button()
                    $('#newjobbutton').click(function(){
                        create_new_job_ui_dialog('', '{{service.id}}')
                        $("#mfileid").val('');
                        $("#serviceid").val('{{service.id}}');
                        $("#dialog-new-job-dialog-form").dialog( "open" );
                    });
                });
            </script>

        </div>
	<div id="tabs-3">

            {% include "methods.html" %}

       </div>
       <div id="tabs-4">
            <h3>Properties</h3>

            <dl>
                <dt>Start Time</dt>
                <dd>
                    {% if service.starttime %}
                        {{service.starttime|date}} {{service.starttime|time}}
                    {% else %}
                        <strong>No Start Time</strong>
                    {% endif %}
                </dd>
                <dt>End Time</dt>
                <dd>
                    {% if service.endtime %}
                        {{service.endtime|date}} {{service.endtime|time}}
                    {% else %}
                        <strong>No End Time</strong>
                    {% endif %}
                </dd>
            </dl>

            <h3>Management Properties</h3>

            <table id="managementpropertyholder" style="vertical-align: middle;" >
                <tr><th>Name</th><th>Current Value</th><th></th><th>New Value</th><th></th></tr>

            </table>

            <script type="text/javascript">
                $(document).ready(function() {
                    service_loadmanagementproperties('{{service.id}}');
                    service_setmanagementproperty('{{service.id}}');
                });
            </script>

            
     </div>
    <div id="tabs-usage">
            {% include "usage.html" %}
     </div>
    	<div id="tabs-6">
            {% include "auths.html" %}
     </div>
</div>

<script>
$(document).ready(function() {
    $(function() {
        $( "#tabs" ).tabs();
    });
});
</script>


</div><!-- End demo -->


<div style="clear:both"></div>

{% endblock %}

{% block rightcontent %}

{% endblock %}

{% block bottomcontent %}

{% endblock %}

